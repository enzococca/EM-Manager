
<!DOCTYPE html>

<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>HELP &#8212; EM-Manager help 1.2.1 documentation</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="APIs" href="api.html" />
    <link rel="prev" title="Welcome to help’s documentation!" href="index.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="help">
<h1>HELP<a class="headerlink" href="#help" title="Permalink to this heading">¶</a></h1>
<blockquote>
<div><div class="toctree-wrapper compound">
</div>
</div></blockquote>
</section>
<section id="help-for-using-em2graphml">
<h1>Help for using EM2Graphml<a class="headerlink" href="#help-for-using-em2graphml" title="Permalink to this heading">¶</a></h1>
<p>ED2Graphml is an application that allows you to convert and verify relationships between data in a CSV file or Google Sheet and transform it into Graphml for EM Tools.</p>
<section id="starting-the-program">
<h2>Starting the program<a class="headerlink" href="#starting-the-program" title="Permalink to this heading">¶</a></h2>
<ol class="arabic simple">
<li><p>Download the provided batch file and place it in the desired folder on your computer.</p></li>
<li><p>Double-click the batch file to launch it.</p></li>
<li><p>The batch file script will take care of checking whether Python and PyQt5 are installed.</p></li>
<li><p>If Python or PyQt5 are not installed, the script will use PackageManagement to install them automatically.</p></li>
<li><p>After installation, the script will launch the main program with a splash screen.</p></li>
<li><p>The splash screen will show the progress of the program loading.</p></li>
<li><p>Once loading is complete, the main program will launch and you can start using it.</p></li>
</ol>
</section>
<section id="main-functions">
<h2>Main functions<a class="headerlink" href="#main-functions" title="Permalink to this heading">¶</a></h2>
<ul class="simple">
<li><p>Load data from a Google Sheet: This feature allows you to load data directly from a Google Sheet.</p></li>
<li><p>Update Reports: This function allows you to update relationships between data.</p></li>
<li><p>3D Viewer: This feature allows you to view data in a 3D format.</p></li>
<li><p>Error checking: This function allows you to check for errors in data relationships.</p></li>
</ul>
</section>
<section id="error-checking-functions">
<h2>Error checking functions<a class="headerlink" href="#error-checking-functions" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml offers several functions to check data relationships for errors:</p>
<ul class="simple">
<li><p>Duplicate Check: This function checks if there are duplicates in the same row.</p></li>
<li><p>Relationship existence check: This function checks whether relationships exist.</p></li>
<li><p>Check existence of inverse relations: This function checks whether inverse relations exist.</p></li>
<li><p>Relationship type check: This function checks whether the relationship type is correct.</p></li>
</ul>
</section>
<section id="select-historical-era">
<h2>Select historical era<a class="headerlink" href="#select-historical-era" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml also offers a feature that allows you to select a historical era from a drop-down list. This list is populated by the data in your CSV file or Google Sheet.</p>
</section>
<section id="saving-data">
<h2>Saving data<a class="headerlink" href="#saving-data" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml allows you to save data to a CSV file or Google Sheet. The “Save CSV” and “Save Google” buttons are linked to the corresponding functions.</p>
</section>
<section id="update-of-reports">
<h2>Update of reports<a class="headerlink" href="#update-of-reports" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml offers two functions for updating data relationships: one for CSV files and one for Google Sheets.</p>
</section>
<section id="updating-relationships-for-csv-files">
<h2>Updating relationships for CSV files<a class="headerlink" href="#updating-relationships-for-csv-files" title="Permalink to this heading">¶</a></h2>
<p>This function opens the CSV file, reads all the rows, and creates a dictionary to store the rows by name. Then, for each row, check the type of stratigraphic unit and update the corresponding relations. Finally, update the table with the updated data.</p>
</section>
<section id="updated-reports-for-google-sheets">
<h2>Updated reports for Google Sheets<a class="headerlink" href="#updated-reports-for-google-sheets" title="Permalink to this heading">¶</a></h2>
<p>This feature works similarly to the feature for CSV files, but instead of opening a CSV file, it opens a Google Sheet. After reading all the rows from the Google Sheet, create a dictionary to store the rows by name. Then, for each row, check the type of stratigraphic unit and update the corresponding relations. Finally, update the table with the updated data.</p>
</section>
<section id="note">
<h2>Note:<a class="headerlink" href="#note" title="Permalink to this heading">¶</a></h2>
<p>For both functions, if the stratigraphic unit is of type ‘property’, ‘document’, ‘combiner’ or ‘extractor’, the ‘properties_ant’ and ‘properties_post’ relations are updated. If the stratigraphic unit is of the ‘contemporary’ type, the ‘contemporary’ relationship is updated. In all other cases, the ‘front’ and ‘back’ relationships are updated.</p>
</section>
<section id="updating-relationships-in-the-dataframe">
<h2>Updating relationships in the DataFrame<a class="headerlink" href="#updating-relationships-in-the-dataframe" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml provides a function to update relations in the DataFrame. This function reads data from the QTableWidget, updates reports in the DataFrame, and displays any errors in the widget dock.</p>
</section>
<section id="viewing-changes">
<h2>Viewing changes<a class="headerlink" href="#viewing-changes" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml offers a function to show the differences between old and new rows. This feature can be used to verify changes made to data.</p>
</section>
<section id="saving-changes">
<h2>Saving changes<a class="headerlink" href="#saving-changes" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml offers a function to ask the user if he wants to save the changes. If the user decides to save the changes, they will be saved to the CSV file and the file will be reloaded.</p>
</section>
<section id="viewing-dialogue-from-the-era">
<h2>Viewing dialogue from the era<a class="headerlink" href="#viewing-dialogue-from-the-era" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml offers a feature to show an epoch dialog when a cell in the “Epoch” column is double-clicked. This function creates an instance of EpochDialog and displays the dialogue to the user.</p>
<p>Saving data to a CSV file or Google Sheet
————————————————– ——–</p>
<p>EM2Graphml offers two functions for saving data: one for CSV files and one for Google Sheets. These functions read data from the QTableWidget, create a new DataFrame with this data, and save the DataFrame to the CSV file or Google Sheet.</p>
</section>
<section id="updating-and-restoring-csv-data">
<h2>Updating and restoring CSV data<a class="headerlink" href="#updating-and-restoring-csv-data" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml offers two functions to update and restore CSV data. The update function updates the original DataFrame with the data from the QTableWidget. The restore function restores the QTableWidget’s data to the original DataFrame.</p>
</section>
<section id="get-the-current-dataframe">
<h2>Get the current DataFrame<a class="headerlink" href="#get-the-current-dataframe" title="Permalink to this heading">¶</a></h2>
<p>EM2Graphml provides a function to get the current DataFrame from the QTableWidget. This function can be used to get the data currently displayed in the QTableWidget.</p>
<section id="update-relationships">
<h3>Update Relationships<a class="headerlink" href="#update-relationships" title="Permalink to this heading">¶</a></h3>
<p>This function reads data from the QTableWidget and adds it to a new DataFrame. It then updates the relationships in the DataFrame. If there are any changes, it will ask the user if they want to save the changes and will save the CSV file if necessary.</p>
</section>
<section id="update-relationships-in-the-dataframe">
<h3>Update Relationships in the DataFrame<a class="headerlink" href="#update-relationships-in-the-dataframe" title="Permalink to this heading">¶</a></h3>
<p>This function takes a DataFrame as input, updates the relations in the DataFrame, and returns the updated DataFrame along with the new header.</p>
</section>
<section id="show-changes">
<h3>Show Changes<a class="headerlink" href="#show-changes" title="Permalink to this heading">¶</a></h3>
<p>This function prints the differences between the old and new lines. If a line has changed, the old line and the new line will be printed.</p>
</section>
</section>
<section id="ask-to-save-changes">
<h2>Ask to Save Changes<a class="headerlink" href="#ask-to-save-changes" title="Permalink to this heading">¶</a></h2>
<p>This feature asks the user if they want to save the changes. If the user chooses to save changes, the changes will be saved to the output CSV file.</p>
<section id="d-graphics-window">
<h3>3D Graphics Window<a class="headerlink" href="#d-graphics-window" title="Permalink to this heading">¶</a></h3>
<p>The GraphWindow class creates a window that displays a 3D graph. This window includes three dockwidgets: “Node Info”, “Next Nodes Info” and “Media Files”. Each dockwidget contains a QTextEdit or QWidget that displays information about the selected node, neighboring nodes, or media files associated with the selected node.</p>
<p>The d_graph function reads a graphml file, retrieves the x, y coordinates for each node and creates a 3D plot of the graph. If 3D models exist that match the node descriptions, they are loaded and displayed as 3D objects in the plot. Otherwise, a 3D image or sphere appears.</p>
<p>The callback function is executed when you click on a point in the 3D plot. Calculate the distance between the selected point and each node in the graph, find the closest node and display the information of this node in the QTextEdit. If the node has an associated media file, it is displayed in the QWidget.</p>
<p>The eventFilter function handles mouse events to start, pause, and stop playing a video when you click the mouse on the QWidget showing the video.</p>
</section>
<section id="pyarchinit-interactive-matrix-class">
<h3>pyarchinit_Interactive_Matrix class<a class="headerlink" href="#pyarchinit-interactive-matrix-class" title="Permalink to this heading">¶</a></h3>
<p>The <cite>pyarchinit_Interactive_Matrix</cite> class handles the generation of an interactive matrix.</p>
<p>The <cite>__init__</cite> method initializes the class and sets the <cite>DATA_LIST</cite> and <cite>ID_US_DICT</cite> variables.</p>
<p>The <cite>csv_connect</cite> method takes care of connecting to the CSV file.</p>
<p>The <cite>urlify</cite> method converts a string to a URL-friendly format, replacing spaces with underscores.</p>
<p>The <cite>generate_matrix</cite> method generates the matrix from the supplied data. Different functions are used to process and organize data.</p>
</section>
<section id="harrismatrix-class">
<h3>HarrisMatrix class<a class="headerlink" href="#harrismatrix-class" title="Permalink to this heading">¶</a></h3>
<p>The <cite>HarrisMatrix</cite> class manages the export of the Harris matrix in different formats.</p>
<p>The <cite>__init__</cite> method initializes the class and sets the <cite>sequence</cite>, <cite>conteporene</cite>, <cite>property</cite> and <cite>periods</cite> variables.</p>
<p>The <cite>export_matrix_2</cite> method generates the Harris matrix using the Graphviz library. Several subgraphs are created to represent the relationships between the data.</p>
</section>
<section id="installing-graphviz">
<h3>Installing Graphviz<a class="headerlink" href="#installing-graphviz" title="Permalink to this heading">¶</a></h3>
<p>The program checks whether Graphviz is installed and whether it is in the operating system’s PATH. Graphviz is required for graph conversion.</p>
<p>The <cite>is_graphviz_installed</cite> function runs the “dot -V” command to check if Graphviz is installed. If the command executes successfully, the function returns True, otherwise it returns False.</p>
<p>The <cite>is_graphviz_in_path</cite> function checks whether the Graphviz bin directory is in the operating system’s PATH. If it is, the function returns True, otherwise it returns False.</p>
<p>The <cite>install_graphviz</cite> function displays a warning message if Graphviz is not installed. The message suggests how to install Graphviz depending on your operating system.</p>
<p>The <cite>set_graphviz_path</cite> function displays a warning message if Graphviz is not in the operating system’s PATH. The message suggests adding the Graphviz directory to your PATH.</p>
<p>The <cite>check_graphviz</cite> function calls the <cite>is_graphviz_installed</cite> and <cite>is_graphviz_in_path</cite> functions, and displays an appropriate message depending on the results. If Graphviz is installed and in the PATH, it shows a message that says “Graphviz is installed and ready to use”.</p>
</section>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index.html">EM-Manager help</a></h1>








<h3>Navigation</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">HELP</a><ul class="simple">
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#help-for-using-em2graphml">Help for using EM2Graphml</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#starting-the-program">Starting the program</a></li>
<li class="toctree-l2"><a class="reference internal" href="#main-functions">Main functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#error-checking-functions">Error checking functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="#select-historical-era">Select historical era</a></li>
<li class="toctree-l2"><a class="reference internal" href="#saving-data">Saving data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#update-of-reports">Update of reports</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-relationships-for-csv-files">Updating relationships for CSV files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updated-reports-for-google-sheets">Updated reports for Google Sheets</a></li>
<li class="toctree-l2"><a class="reference internal" href="#note">Note:</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-relationships-in-the-dataframe">Updating relationships in the DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="#viewing-changes">Viewing changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#saving-changes">Saving changes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#viewing-dialogue-from-the-era">Viewing dialogue from the era</a></li>
<li class="toctree-l2"><a class="reference internal" href="#updating-and-restoring-csv-data">Updating and restoring CSV data</a></li>
<li class="toctree-l2"><a class="reference internal" href="#get-the-current-dataframe">Get the current DataFrame</a></li>
<li class="toctree-l2"><a class="reference internal" href="#ask-to-save-changes">Ask to Save Changes</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">APIs</a></li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index.html">Documentation overview</a><ul>
      <li>Previous: <a href="index.html" title="previous chapter">Welcome to help’s documentation!</a></li>
      <li>Next: <a href="api.html" title="next chapter">APIs</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Go" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Enzo Cocca.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/help.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>