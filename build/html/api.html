
<!DOCTYPE html>

<html lang="it">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>API &#8212; EM-Manager help 1.2.1 documentazione</title>
    <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="_static/alabaster.css" />
    <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
    <script src="_static/jquery.js"></script>
    <script src="_static/underscore.js"></script>
    <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
    <script src="_static/doctools.js"></script>
    <script src="_static/sphinx_highlight.js"></script>
    <script src="_static/translations.js"></script>
    <link rel="index" title="Indice" href="genindex.html" />
    <link rel="search" title="Cerca" href="search.html" />
    <link rel="prev" title="HELP" href="help.html" />
   
  <link rel="stylesheet" href="_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head><body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          

          <div class="body" role="main">
            
  <section id="api">
<h1>API<a class="headerlink" href="#api" title="Permalink to this heading">¶</a></h1>
<div class="toctree-wrapper compound">
</div>
<section id="la-classe-epochdialog">
<h2>La classe <cite>EpochDialog</cite><a class="headerlink" href="#la-classe-epochdialog" title="Permalink to this heading">¶</a></h2>
<p>La classe <cite>EpochDialog</cite> rappresenta una finestra di dialogo che consente all’utente di selezionare un’epoca storica da una lista di opzioni.</p>
</section>
<section id="la-classe-unitdialog">
<h2>La classe <cite>UnitDialog</cite><a class="headerlink" href="#la-classe-unitdialog" title="Permalink to this heading">¶</a></h2>
<p>La classe <cite>UnitDialog</cite> rappresenta una finestra di dialogo che consente all’utente di selezionare un’unità di misura da una lista di opzioni.</p>
</section>
<section id="la-classe-csvmapper">
<h2>La classe <cite>CSVMapper</cite><a class="headerlink" href="#la-classe-csvmapper" title="Permalink to this heading">¶</a></h2>
<p>La classe <cite>CSVMapper</cite> rappresenta la finestra principale dell’applicazione.</p>
</section>
<section id="funzioni">
<h2>Funzioni<a class="headerlink" href="#funzioni" title="Permalink to this heading">¶</a></h2>
</section>
<section id="la-funzione-check-relation-exists">
<h2>La funzione <cite>check_relation_exists</cite><a class="headerlink" href="#la-funzione-check-relation-exists" title="Permalink to this heading">¶</a></h2>
</section>
<section id="la-funzione-check-inverse-relation-exists">
<h2>La funzione <cite>check_inverse_relation_exists</cite><a class="headerlink" href="#la-funzione-check-inverse-relation-exists" title="Permalink to this heading">¶</a></h2>
</section>
<section id="la-funzione-check-relation-type">
<h2>La funzione <cite>check_relation_type</cite><a class="headerlink" href="#la-funzione-check-relation-type" title="Permalink to this heading">¶</a></h2>
<p>Google Sheet». Una volta caricati i dati, vengono visualizzati nella tabella dei dati.</p>
<p>L’utente può eseguire diverse azioni sulla tabella dei dati, come l’aggiunta, l’eliminazione o la modifica di righe e colonne. È anche possibile ordinare i dati in base a una colonna specifica.</p>
<p>La classe <cite>EpochDialog</cite> e <cite>UnitDialog</cite> forniscono finestre di dialogo per la selezione delle epoche storiche e delle unità di misura.</p>
<p>Le funzioni <cite>show_epoch_dialog</cite> e <cite>show_unit_dialog</cite> vengono chiamate quando l’utente fa doppio clic su una cella nella colonna «Epoca» o «Unità» della tabella dei dati. Queste funzioni mostrano le finestre di dialogo delle epoche storiche e delle unità di misura, rispettivamente, e consentono all’utente di selezionare un’epoca o un’unità dalla combobox.</p>
<p>Le funzioni <cite>on_google_sheet_action_triggered</cite>, <cite>save_csv</cite> e <cite>save_google</cite> gestiscono il salvataggio dei dati su Google Sheets o su file CSV.</p>
<p>La funzione <cite>update_relations</cite> gestisce l’aggiornamento delle relazioni tra le unità stratigrafiche presenti nella tabella dei dati. Questa funzione legge il file CSV o il foglio di calcolo Google Sheets, aggiorna le relazioni tra le unità stratigrafiche e restituisce un DataFrame contenente le righe aggiornate.</p>
<p>La funzione <cite>update_relationships_in_dataframe</cite> aggiorna le relazioni tra le unità stratigrafiche presenti in un DataFrame specifico.</p>
<p>Le funzioni <cite>show_changes</cite> e <cite>ask_to_save_changes</cite> vengono chiamate quando l’utente apporta modifiche alla tabella dei dati e deve decidere se salvare le modifiche su un file CSV.</p>
<p>Le variabili <cite>data_table</cite>, <cite>epochs_df</cite>, <cite>unit_df</cite>, <cite>spreadsheet_id</cite>, <cite>df</cite>, <cite>data_fields</cite>, <cite>df2</cite> e <cite>data_fields2</cite> vengono utilizzate come contenitori per i dati.
(«epoca index»)</p>
<dl>
<dt><a href="#id1"><span class="problematic" id="id2">``</span></a><a href="#id3"><span class="problematic" id="id4">`</span></a></dt><dd><blockquote>
<div><blockquote>
<div><blockquote>
<div><p>rapporti_idx = header.index(«rapporti»)</p>
<p># Read the data rows
for row in reader:
#Split the rapporti column into a list of strings
rapporti = row[rapporti_idx].split(«,»)</p>
<p>#Create a dictionary of ID-US key-value pairs
id_us_dict[row[us_idx]] = row[unita_tipo_idx]</p>
<p>#Add the row data to the data list
data_list.append([row[us_idx], row[unita_tipo_idx], row[descrizione_idx], row[epoca_idx], row[e_idx], rapporti])</p>
</div></blockquote>
<p># Convert the data list to a pandas DataFrame and populate the data table
self.df = pd.DataFrame(data_list, columns=header)
self.populate_table()</p>
<p>return data_list, id_us_dict</p>
</div></blockquote>
<dl class="simple">
<dt>except IOError as e:</dt><dd><p>print(f»Error reading the file: {e}»)
raise e</p>
</dd>
</dl>
</div></blockquote>
<dl>
<dt>def populate_table(self):</dt><dd><p>«»»
Populates the data table with the data from the pandas DataFrame.</p>
<p>«»»
self.data_table.setRowCount(len(self.df.index))
self.data_table.setColumnCount(len(self.df.columns))
self.data_table.setHorizontalHeaderLabels(self.df.columns)</p>
<dl class="simple">
<dt>for row in range(len(self.df.index)):</dt><dd><dl class="simple">
<dt>for col in range(len(self.df.columns)):</dt><dd><p>item = QTableWidgetItem(str(self.df.iloc[row, col]))
self.data_table.setItem(row, col, item)</p>
</dd>
</dl>
</dd>
</dl>
</dd>
<dt>def get_current_dataframe(self):</dt><dd><p>«»»
Returns a pandas DataFrame containing the data from the data table.</p>
<dl class="simple">
<dt>Returns:</dt><dd><p>DataFrame: A pandas DataFrame containing the data from the data table.</p>
</dd>
</dl>
<p>«»»
headers = [self.data_table.horizontalHeaderItem(i).text() for i in range(self.data_table.columnCount())]
data = [[self.data_table.item(row, col).text() for col in range(self.data_table.columnCount())] for row in range(self.data_table.rowCount())]
return pd.DataFrame(data, columns=headers)</p>
</dd>
<dt>def transform_data_google(self, file_buffer, output_buffer):</dt><dd><p>«»»
Transforms the data in a CSV file to a format compatible with Google Sheets.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>file_buffer (BytesIO): A buffer containing the CSV file data.
output_buffer (BytesIO): A buffer where the transformed data will be written.</p>
</dd>
</dl>
<p>«»»
data = pd.read_csv(file_buffer)</p>
<p># Convert the «rapporti» column to a list
data[“rapporti”] = data[“rapporti”].apply(lambda x: x.split(«,»))</p>
<p># Convert the data to a format compatible with Google Sheets
data[“properties_ant”] = data.apply(lambda row: {row[“anteriore”]: row[“properties_ant”]}, axis=1)
data[“properties_post”] = data.apply(lambda row: {row[“posteriore”]: row[“properties_post”]}, axis=1)
data = data.groupby([“nome us”, “tipo”, “descrizione”, “epoca”, “epoca index”, “contemporaneo”, “rapporti”])[[“properties_ant”, “properties_post”]].apply(lambda x: x.to_dict(“list”)).reset_index(name=”properties”)</p>
<p># Write the transformed data to the output buffer
data.to_csv(output_buffer, index=False)</p>
</dd>
<dt>def update_csv(self, data_list):</dt><dd><p>«»»
Updates the data in the pandas DataFrame and the data table.</p>
<dl class="simple">
<dt>Args:</dt><dd><p>data_list (list): A list of lists containing the updated data.</p>
</dd>
</dl>
<p>«»»
# Convert the data list to a pandas DataFrame and update the original DataFrame
self.df = pd.DataFrame(data_list, columns=self.df.columns)</p>
<p># Repopulate the data table
self.populate_table()</p>
</dd>
<dt>def rollback_csv(self):</dt><dd><p>«»»
Rolls back the data in the data table to the original values from the CSV file.</p>
<p>«»»
# Reload the original CSV file and repopulate the data table
data_list, id_us_dict = self.load_csv(self.filename)
self.populate_table()</p>
</dd>
</dl>
</dd>
</dl>
<p><a href="#id5"><span class="problematic" id="id6">``</span></a>`
.. _documentazione:</p>
</section>
</section>
<section id="documentazione">
<h1>Documentazione<a class="headerlink" href="#documentazione" title="Permalink to this heading">¶</a></h1>
<p>Questo modulo contiene diverse classi e funzioni utilizzate per controllare la coerenza dei dati presenti in un file CSV.</p>
<section id="id7">
<h2>Funzioni<a class="headerlink" href="#id7" title="Permalink to this heading">¶</a></h2>
<section id="check-file-consistency-csv-file-str-output-file-str-tuple-list-list-str-dict-str-dict-str-str">
<h3><code class="docutils literal notranslate"><span class="pre">check_file_consistency(csv_file:</span> <span class="pre">str,</span> <span class="pre">output_file:</span> <span class="pre">str)</span> <span class="pre">-&gt;</span> <span class="pre">Tuple[List[List[str]],</span> <span class="pre">Dict[str,</span> <span class="pre">Dict[str,</span> <span class="pre">str]]]</span></code><a class="headerlink" href="#check-file-consistency-csv-file-str-output-file-str-tuple-list-list-str-dict-str-dict-str-str" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione legge i dati dal file CSV specificato, controlla la coerenza tra le relazioni degli <em>Unità Stratigrafiche</em> (US) e restituisce i dati letti e un dizionario di ID per US.</p>
<p>Argomenti:
- <code class="docutils literal notranslate"><span class="pre">csv_file</span></code>: il percorso del file CSV contenente i dati da leggere.
- <code class="docutils literal notranslate"><span class="pre">output_file</span></code>: il percorso del file di output contenente gli errori di coerenza (se presenti).</p>
<p>Restituisce:
- <code class="docutils literal notranslate"><span class="pre">data_list</span></code>: una lista di liste contenente i dati letti dal file CSV.
- <code class="docutils literal notranslate"><span class="pre">id_us_dict</span></code>: un dizionario di ID per US letto dal file CSV.</p>
</section>
<section id="check-consistency-csv-file-str-output-file-str">
<h3><code class="docutils literal notranslate"><span class="pre">check_consistency(csv_file:</span> <span class="pre">str,</span> <span class="pre">output_file:</span> <span class="pre">str)</span></code><a class="headerlink" href="#check-consistency-csv-file-str-output-file-str" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione controlla la coerenza tra le relazioni degli <em>Unità Stratigrafiche</em> (US) presenti nel file CSV specificato e scrive i risultati nel file di output specificato.</p>
<p>Argomenti:
- <code class="docutils literal notranslate"><span class="pre">csv_file</span></code>: il percorso del file CSV contenente i dati da leggere.
- <code class="docutils literal notranslate"><span class="pre">output_file</span></code>: il percorso del file di output contenente gli errori di coerenza (se presenti).</p>
</section>
<section id="show-errors-in-dock-widget-text-str">
<h3><code class="docutils literal notranslate"><span class="pre">show_errors_in_dock_widget(text:</span> <span class="pre">str)</span></code><a class="headerlink" href="#show-errors-in-dock-widget-text-str" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione mostra il testo specificato nel widget a scomparsa.</p>
<p>Argomenti:
- <code class="docutils literal notranslate"><span class="pre">text</span></code>: il testo da mostrare.</p>
</section>
<section id="check-consistency-google">
<h3><code class="docutils literal notranslate"><span class="pre">check_consistency_google()</span></code><a class="headerlink" href="#check-consistency-google" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione controlla la coerenza tra le relazioni degli <em>Unità Stratigrafiche</em> (US) presenti nel DataFrame e restituisce i risultati come stringa.</p>
<p>Restituisce:
- <code class="docutils literal notranslate"><span class="pre">str</span></code>: una stringa contenente gli errori di coerenza (se presenti).</p>
</section>
<section id="show-errors-in-dock-widget-google-errors-str">
<h3><code class="docutils literal notranslate"><span class="pre">show_errors_in_dock_widget_google(errors:</span> <span class="pre">str)</span></code><a class="headerlink" href="#show-errors-in-dock-widget-google-errors-str" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione mostra gli errori specificati nel widget a scomparsa.</p>
<p>Argomenti:
- <code class="docutils literal notranslate"><span class="pre">errors</span></code>: gli errori da mostrare.</p>
</section>
<section id="show-error-message-str">
<h3><code class="docutils literal notranslate"><span class="pre">show_error(message:</span> <span class="pre">str)</span></code><a class="headerlink" href="#show-error-message-str" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione mostra un messaggio di errore.</p>
<p>Argomenti:
- <code class="docutils literal notranslate"><span class="pre">message</span></code>: il messaggio di errore.</p>
</section>
<section id="show-info-message-str">
<h3><code class="docutils literal notranslate"><span class="pre">show_info(message:</span> <span class="pre">str)</span></code><a class="headerlink" href="#show-info-message-str" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione mostra un messaggio informativo.</p>
<p>Argomenti:
- <code class="docutils literal notranslate"><span class="pre">message</span></code>: il messaggio da mostrare.</p>
</section>
<section id="on-pushbutton-addrow-pressed">
<h3><code class="docutils literal notranslate"><span class="pre">on_pushButton_addrow_pressed()</span></code><a class="headerlink" href="#on-pushbutton-addrow-pressed" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione aggiunge una riga alla tabella dei dati.</p>
</section>
<section id="on-pushbutton-removerow-pressed">
<h3><code class="docutils literal notranslate"><span class="pre">on_pushButton_removerow_pressed()</span></code><a class="headerlink" href="#on-pushbutton-removerow-pressed" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione rimuove la riga selezionata dalla tabella dei dati.</p>
</section>
<section id="add-row">
<h3><code class="docutils literal notranslate"><span class="pre">add_row()</span></code><a class="headerlink" href="#add-row" title="Permalink to this heading">¶</a></h3>
<p>Questa funzione aggiunge una riga alla tabella dei dati.</p>
</section>
</section>
<section id="classi">
<h2>Classi<a class="headerlink" href="#classi" title="Permalink to this heading">¶</a></h2>
<section id="mainwindow-qmainwindow">
<h3><code class="docutils literal notranslate"><span class="pre">MainWindow(QMainWindow)</span></code><a class="headerlink" href="#mainwindow-qmainwindow" title="Permalink to this heading">¶</a></h3>
<p>Questa classe contiene la finestra principale dell’applicazione.</p>
</section>
</section>
<section id="note">
<h2>Note<a class="headerlink" href="#note" title="Permalink to this heading">¶</a></h2>
<p>La documentazione è stata generata utilizzando il formato di markup reStructuredText e il tool di generazione della documentazione Sphinx.</p>
</section>
</section>


          </div>
          
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<h1 class="logo"><a href="index2.html">EM-Manager help</a></h1>








<h3>Navigazione</h3>
<p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="help.html">HELP</a></li>
<li class="toctree-l1"><a class="reference internal" href="help.html#aiuto-per-l-uso-del-em2graphml">Aiuto per l’uso del EM2Graphml</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">API</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#la-classe-epochdialog">La classe <cite>EpochDialog</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="#la-classe-unitdialog">La classe <cite>UnitDialog</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="#la-classe-csvmapper">La classe <cite>CSVMapper</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="#funzioni">Funzioni</a></li>
<li class="toctree-l2"><a class="reference internal" href="#la-funzione-check-relation-exists">La funzione <cite>check_relation_exists</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="#la-funzione-check-inverse-relation-exists">La funzione <cite>check_inverse_relation_exists</cite></a></li>
<li class="toctree-l2"><a class="reference internal" href="#la-funzione-check-relation-type">La funzione <cite>check_relation_type</cite></a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="#documentazione">Documentazione</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id7">Funzioni</a></li>
<li class="toctree-l2"><a class="reference internal" href="#classi">Classi</a></li>
<li class="toctree-l2"><a class="reference internal" href="#note">Note</a></li>
</ul>
</li>
</ul>

<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="index2.html">Documentation overview</a><ul>
      <li>Previous: <a href="help.html" title="capitolo precedente">HELP</a></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3 id="searchlabel">Ricerca veloce</h3>
    <div class="searchformwrapper">
    <form class="search" action="search.html" method="get">
      <input type="text" name="q" aria-labelledby="searchlabel" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false"/>
      <input type="submit" value="Vai" />
    </form>
    </div>
</div>
<script>document.getElementById('searchbox').style.display = "block"</script>








        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2023, Enzo Cocca.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 5.3.0</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.13</a>
      
      |
      <a href="_sources/api.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    

    
  </body>
</html>